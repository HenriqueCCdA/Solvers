#include<stdio.h>
#include<stdlib.h>
#include<Gauss.h>    
double dot(double *a,double *b,int const n);

/*********************************************************************/ 
int main(int argc,char *argv[]){

  
  double a[25],b1[5],b2[5];
  double norm1,norm2,du[5];
  int i;
/*  double ad[4],au[6],al[6];
  int    jd[4];*/
/*        
  a[0] = 10.0; 
  a[1] = 20.0; 
  a[2] = 30.0; 
  a[3] = 20.0; 
  a[4] = 45.0; 
  a[5] = 80.0; 
  a[6] = 30.0; 
  a[7] = 80.0; 
  a[8] =171.0;
  b1[0] = 1.0;
  b1[1] = 1.0;
  b1[2] = 1.0;
*/  
/*  
  a[0] = 1.0; 
  a[1] = 4.0; 
  a[2] = 7.0; 
  a[3] = 2.0; 
  a[4] = 5.0; 
  a[5] = 8.0; 
  a[6] = 3.0; 
  a[7] = 6.0; 
  a[8] =11.0;
*/

/*  
  a[ 0] = 10.0; 
  a[ 1] = -1.0; 
  a[ 2] = -2.0; 
  a[ 3] = -3.0; 
  a[ 4] = -1.0; 
  a[ 5] =  5.0; 
  a[ 6] = -2.0; 
  a[ 7] = -2.0; 
  a[ 8] = -2.0; 
  a[ 9] = -2.0;
  a[10] =  6.0;
  a[11] = -1.0;
  a[12] = -3.0;
  a[13] = -2.0;
  a[14] = -1.0;
  a[15] = 11.0;
  b[0] =  1.0;
  b[1] =  1.0;
  b[2] =  2.0;
  b[3] = -2.0;
*/  
  
  a[ 0] = 10.0; 
  a[ 1] =  0.0; 
  a[ 2] = -2.0; 
  a[ 3] = -3.0; 
  a[ 4] =  0.0; 
  a[ 5] =  0.0; 
  a[ 6] = 20.0; 
  a[ 7] = -2.0; 
  a[ 8] =  0.0; 
  a[ 9] = -4.0; 
  a[10] = -2.0; 
  a[11] = -2.0; 
  a[12] = 20.0; 
  a[13] =  0.0; 
  a[14] =  0.0; 
  a[15] = -3.0;
  a[16] =  0.0;
  a[17] =  0.0;
  a[18] = 30.0;
  a[19] =  0.0;
  a[20] =  0.0;
  a[21] = -4.0;
  a[22] =  0.0;
  a[23] =  0.0;
  a[24] = 90.0;
  b1[0] =  1.0;
  b1[1] =  1.0;
  b1[2] =  -2.0;
  b1[3] =  1.0;
  b1[4] =  -1.0;
  
  solverD(a,b1,5,GGT,false);
  printf("%.8f\n",b1[0]);
  printf("%.8f\n",b1[1]);
  printf("%.8f\n",b1[2]);
  printf("%.8f\n",b1[3]);
  printf("%.8f\n",b1[4]);
  
  exit(0); 
 
  a[ 0] =  1.0e-12; 
  a[ 1] = -1.0e0; 
  a[ 2] = -2.0e0; 
  a[ 3] = -3.0e0; 
  a[ 4] = -4.0e0; 
  a[ 5] = -1.0e0; 
  a[ 6] = 20.0e0; 
  a[ 7] = -2.0e0; 
  a[ 8] = -3.0; 
  a[ 9] = -4.0; 
  a[10] = -1.0; 
  a[11] = -2.0; 
  a[12] =  3.0e-13; 
  a[13] = -3.0; 
  a[14] = -4.0; 
  a[15] = -1.0;
  a[16] = -2.0;
  a[17] = -3.0;
  a[18] =  3.0e-10;
  a[19] = -4.0e0;
  a[20] = -1.0e0;
  a[21] = -2.0e0;
  a[22] = -3.0e0;
  a[23] = 50.0e0;
  a[24] =  5.0e-10;
  b2[0] =  1.0e0;
  b2[1] =  1.0e0;
  b2[2] =  2.0e0;
  b2[3] = -2.0e0;
  b2[4] =  1.0e0;
/*    
  a[0] =  0.986; 
  a[1] =  0.579;
  a[2] =  0.409; 
  a[3] =  0.237; 
  b2[0] = 0.235;
  b2[1] = 0.107;
*/  
  solverD(a,b2,5,DOOLITTLECLPP,true);
  
  printf("%.14e\n",b2[0]);
  printf("%.14e\n",b2[1]);
//printf("%.14e\n",b2[2]);
//printf("%.14e\n",b2[3]);
//printf("%.14e\n",b2[4]);
  
  for(i=0;i<5;i++){
    du[i] = b1[i]-b2[i];
  }
  norm1 = sqrt(dot(du,du,5));
  norm2 = sqrt(dot(b2,b2,5));
  printf("erro |b1-b2|2 / |b2|2 = %.14e\n",norm1/norm2);
    
  return EXIT_SUCCESS;
}

